<div>
    <% depth ||= 0 %>
    <% children_to_display ||= comment.children %>
    <h5><%= display_user_link(comment.user) %> wrote at <%= display_created_at(comment) %>:</h5>
    <p><%= comment.content %></p>
    <h6>
        <%= link_to "View", article_comment_path(comment.article_id, comment.id) %>
         - <%= link_to "Reply", new_article_comment_path(comment.article_id) %>
        <% if current_user_is?(comment.user) %>
             - <%= link_to "Edit", edit_article_comment_path(comment.article_id, comment.id) %>
             - <%= link_to "Delete", delete_article_comment_path(comment.article_id, comment.id) %>
        <% end %>
    </h6>
    <% unless children_to_display.empty? %>
        <table>
        <tr>
        <td class="side-stripe"></td>
        <td class="level-<%= comment.true_depth %>-stripe"></td>
        <td class="side-stripe"></td>
        <td>
            <% if depth < max_display_depth %>
                <% children_to_display.each do |child| %>
                    <%= render partial: 'comments/comment', locals: { comment: child, depth: depth + 1 } %>
                <% end %>
            <% else %>
                <%= link_to "See more replies", article_comment_path(comment.article_id, comment.id) %>
            <% end %>
        </td>
        </tr>
        </table>
    <% end %>
</div>